# 使用指南和故障排除

## 🚀 快速开始

### 1. 安装插件

1. 打开 Chrome 浏览器
2. 访问 `chrome://extensions/`
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择 `redbook-tools` 文件夹
6. 看到插件图标出现在工具栏，安装成功！

### 2. 配置发布内容

编辑 `source/mock.json` 文件：

```json
{
  "title": "你的标题（最多20字）",
  "content": "你的正文内容",
  "tags": ["#标签1", "#标签2", "#标签3"],
  "commodityId": ["商品ID1", "商品ID2"]
}
```

### 3. 使用插件

1. 打开小红书创作中心：https://creator.xiaohongshu.com/publish/publish
2. 点击浏览器工具栏的插件图标
3. 点击"一键自动填充"按钮
4. 等待填充完成（3-5 秒）
5. 检查内容，手动上传图片
6. 点击页面的"发布"按钮

## 🔧 故障排除

### ❌ 错误：消息端口关闭

**错误信息：** "The message port closed before a response was received."

**原因：**

- Content script 还未加载完成
- 页面刚刷新，脚本还在初始化

**解决方法：**

1. **刷新页面** - 按 F5 或点击刷新按钮
2. **等待加载** - 确保页面完全加载后再点击插件
3. **检查状态** - 打开插件弹窗，查看状态提示
   - ✓ 显示"就绪"表示可以使用
   - ⚠️ 显示"请刷新"表示需要刷新页面

### ❌ 错误：未找到元素

**错误信息：** "未找到标题输入框" 或 "未找到正文输入框"

**原因：**

- 页面结构发生变化
- 页面还未完全加载
- 网络延迟导致元素加载慢

**解决方法：**

1. 等待页面完全加载（看到所有输入框）
2. 刷新页面重试
3. 检查是否在正确的发布页面

### ❌ 错误：数据加载失败

**错误信息：** "无法加载配置数据"

**原因：**

- `mock.json` 文件格式错误
- 文件路径不正确

**解决方法：**

1. 检查 `source/mock.json` 文件是否存在
2. 使用 JSON 验证器检查格式：https://jsonlint.com/
3. 确保 JSON 格式正确（引号、逗号、括号）

### ⚠️ 商品选择失败

**情况：** 商品没有自动选择

**原因：**

- 商品 ID 不存在
- 商品未在你的商品库中
- 商品选择弹窗结构变化

**解决方法：**

1. 不影响其他内容的填充，可以手动选择商品
2. 检查商品 ID 是否正确
3. 确认商品在你的账号商品库中存在

## 🐛 调试技巧

### 查看控制台日志

1. 打开小红书发布页面
2. 按 F12 打开开发者工具
3. 切换到 Console 标签页
4. 点击插件的"一键填充"按钮
5. 查看详细的执行日志

**日志含义：**

- `🚀 开始自动填充` - 流程开始
- `✅ 数据加载完成` - 配置读取成功
- `✅ 找到元素` - 成功定位页面元素
- `✅ 标题填充完成` - 标题填充成功
- `✅ 正文填充完成` - 正文填充成功
- `⚠️` - 警告信息，可能不影响主要功能
- `❌` - 错误信息，需要处理

### 检查插件状态

**方法 1：查看弹窗状态**

- 打开插件弹窗
- 查看底部状态栏
- 绿色 ✓ 表示正常
- 红色 ✕ 表示异常

**方法 2：查看 Background 日志**

1. 访问 `chrome://extensions/`
2. 找到"小红书发布助手"
3. 点击"service worker" 或"背景页"链接
4. 查看 Console 日志

### 重新加载插件

如果修改了代码或配置：

1. 访问 `chrome://extensions/`
2. 找到"小红书发布助手"
3. 点击"重新加载"按钮 🔄
4. 刷新小红书页面
5. 重新测试

## 💡 使用技巧

### 技巧 1：批量准备内容

创建多个配置文件：

- `mock-1.json` - 第一篇内容
- `mock-2.json` - 第二篇内容
- `mock-3.json` - 第三篇内容

需要发布时，重命名为 `mock.json` 即可。

### 技巧 2：标签格式

标签支持两种格式：

- `#标签名` - 简单格式
- `#标签名[话题]#` - 完整格式

插件会自动处理，建议使用简单格式。

### 技巧 3：内容模板

创建常用的内容模板：

```json
{
  "title": "【模板】[标题占位符]",
  "content": "模板正文内容...\n\n[具体内容]\n\n记得点赞收藏哦～",
  "tags": ["#固定标签1", "#固定标签2"],
  "commodityId": []
}
```

### 技巧 4：快速测试

测试时使用简单内容：

```json
{
  "title": "测试标题",
  "content": "测试内容",
  "tags": ["#测试"],
  "commodityId": []
}
```

## 📋 检查清单

使用前检查：

- [ ] 已在小红书发布页面
- [ ] 页面完全加载完成
- [ ] `mock.json` 格式正确
- [ ] 插件已正确安装
- [ ] 弹窗状态显示"就绪"

填充后检查：

- [ ] 标题是否正确
- [ ] 正文是否完整
- [ ] 标签是否显示
- [ ] 商品是否选择（如需要）
- [ ] 图片是否上传（手动）

## 🆘 获取帮助

如果以上方法都无法解决问题：

1. **查看 README.md** - 查看详细文档
2. **检查浏览器版本** - 确保使用最新版 Chrome
3. **清除缓存** - 清除浏览器缓存后重试
4. **重新安装** - 删除插件后重新安装

## ⚙️ 高级设置

### 修改等待时间

如果网络慢或页面加载慢，可以调整等待时间：

编辑 `content.js`，找到这些行：

```javascript
await this.sleep(500); // 改为 await this.sleep(1000);
```

增加等待时间可以提高成功率，但会让填充过程变慢。

### 自定义选择器

如果页面结构变化导致元素无法找到，可以更新选择器：

编辑 `content.js`，找到 `selectors` 数组，添加新的选择器。

## 🎯 最佳实践

1. **先测试再使用** - 用测试内容先测试一次
2. **保持页面打开** - 不要在填充过程中切换标签页
3. **检查后发布** - 自动填充后务必检查内容
4. **保存草稿** - 重要内容先保存为草稿
5. **备份配置** - 定期备份 `mock.json` 文件

---

祝你使用愉快！如有问题，欢迎反馈。
